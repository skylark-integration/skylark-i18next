{"version":3,"sources":["PluralResolver.js"],"names":["define","baseLogger","sets","lngs","nr","fc","_rulesPluralsTypes","1","n","Number","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","[object Object]","languageUtils","options","this","logger","create","rules","forEach","set","l","numbers","plurals","createRules","lng","obj","code","getLanguagePartFromCode","rule","getRule","length","key","ret","suffix","getSuffix","push","count","idx","noAbs","Math","abs","simplifyPluralSuffix","returnSuffix","prepend","toString","compatibilityJSON","warn"],"mappings":";;;;;;;AAAAA,QAAQ,YAAa,SAAUC,GAC3B,aACA,IAAIC,IAEIC,MACI,MACA,KACA,KACA,MACA,KACA,MACA,MACA,KACA,MACA,KACA,KACA,KACA,KACA,QACA,KACA,KACA,KACA,KACA,MAEJC,IACI,EACA,GAEJC,GAAI,IAGJF,MACI,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,MACA,MACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,MACA,MACA,KACA,QACA,KACA,MACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MAEJC,IACI,EACA,GAEJC,GAAI,IAGJF,MACI,KACA,KACA,MACA,KACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,MAEJC,IAAK,GACLC,GAAI,IAGJF,MACI,KACA,KACA,MACA,KACA,KACA,KACA,KACA,MAEJC,IACI,EACA,EACA,GAEJC,GAAI,IAGJF,MAAO,MACPC,IACI,EACA,EACA,EACA,EACA,GACA,KAEJC,GAAI,IAGJF,MACI,KACA,MAEJC,IACI,EACA,EACA,GAEJC,GAAI,IAGJF,MACI,MACA,MAEJC,IACI,EACA,EACA,GAEJC,GAAI,IAGJF,MAAO,MACPC,IACI,EACA,EACA,EACA,GAEJC,GAAI,IAGJF,MAAO,MACPC,IACI,EACA,GAEJC,GAAI,IAGJF,MAAO,MACPC,IACI,EACA,EACA,EACA,EACA,IAEJC,GAAI,KAGJF,MAAO,MACPC,IACI,EACA,EACA,EACA,IAEJC,GAAI,KAGJF,MAAO,MACPC,IACI,EACA,GAEJC,GAAI,KAGJF,MAAO,MACPC,IACI,EACA,GAEJC,GAAI,KAGJF,MAAO,MACPC,IACI,EACA,EACA,EACA,GAEJC,GA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","file":"../PluralResolver.js","sourcesContent":["define(['./logger'], function (baseLogger) {\n    'use strict';\n    let sets = [\n        {\n            lngs: [\n                'ach',\n                'ak',\n                'am',\n                'arn',\n                'br',\n                'fil',\n                'gun',\n                'ln',\n                'mfe',\n                'mg',\n                'mi',\n                'oc',\n                'pt',\n                'pt-BR',\n                'tg',\n                'ti',\n                'tr',\n                'uz',\n                'wa'\n            ],\n            nr: [\n                1,\n                2\n            ],\n            fc: 1\n        },\n        {\n            lngs: [\n                'af',\n                'an',\n                'ast',\n                'az',\n                'bg',\n                'bn',\n                'ca',\n                'da',\n                'de',\n                'dev',\n                'el',\n                'en',\n                'eo',\n                'es',\n                'et',\n                'eu',\n                'fi',\n                'fo',\n                'fur',\n                'fy',\n                'gl',\n                'gu',\n                'ha',\n                'hi',\n                'hu',\n                'hy',\n                'ia',\n                'it',\n                'kn',\n                'ku',\n                'lb',\n                'mai',\n                'ml',\n                'mn',\n                'mr',\n                'nah',\n                'nap',\n                'nb',\n                'ne',\n                'nl',\n                'nn',\n                'no',\n                'nso',\n                'pa',\n                'pap',\n                'pms',\n                'ps',\n                'pt-PT',\n                'rm',\n                'sco',\n                'se',\n                'si',\n                'so',\n                'son',\n                'sq',\n                'sv',\n                'sw',\n                'ta',\n                'te',\n                'tk',\n                'ur',\n                'yo'\n            ],\n            nr: [\n                1,\n                2\n            ],\n            fc: 2\n        },\n        {\n            lngs: [\n                'ay',\n                'bo',\n                'cgg',\n                'fa',\n                'ht',\n                'id',\n                'ja',\n                'jbo',\n                'ka',\n                'kk',\n                'km',\n                'ko',\n                'ky',\n                'lo',\n                'ms',\n                'sah',\n                'su',\n                'th',\n                'tt',\n                'ug',\n                'vi',\n                'wo',\n                'zh'\n            ],\n            nr: [1],\n            fc: 3\n        },\n        {\n            lngs: [\n                'be',\n                'bs',\n                'cnr',\n                'dz',\n                'hr',\n                'ru',\n                'sr',\n                'uk'\n            ],\n            nr: [\n                1,\n                2,\n                5\n            ],\n            fc: 4\n        },\n        {\n            lngs: ['ar'],\n            nr: [\n                0,\n                1,\n                2,\n                3,\n                11,\n                100\n            ],\n            fc: 5\n        },\n        {\n            lngs: [\n                'cs',\n                'sk'\n            ],\n            nr: [\n                1,\n                2,\n                5\n            ],\n            fc: 6\n        },\n        {\n            lngs: [\n                'csb',\n                'pl'\n            ],\n            nr: [\n                1,\n                2,\n                5\n            ],\n            fc: 7\n        },\n        {\n            lngs: ['cy'],\n            nr: [\n                1,\n                2,\n                3,\n                8\n            ],\n            fc: 8\n        },\n        {\n            lngs: ['fr'],\n            nr: [\n                1,\n                2\n            ],\n            fc: 9\n        },\n        {\n            lngs: ['ga'],\n            nr: [\n                1,\n                2,\n                3,\n                7,\n                11\n            ],\n            fc: 10\n        },\n        {\n            lngs: ['gd'],\n            nr: [\n                1,\n                2,\n                3,\n                20\n            ],\n            fc: 11\n        },\n        {\n            lngs: ['is'],\n            nr: [\n                1,\n                2\n            ],\n            fc: 12\n        },\n        {\n            lngs: ['jv'],\n            nr: [\n                0,\n                1\n            ],\n            fc: 13\n        },\n        {\n            lngs: ['kw'],\n            nr: [\n                1,\n                2,\n                3,\n                4\n            ],\n            fc: 14\n        },\n        {\n            lngs: ['lt'],\n            nr: [\n                1,\n                2,\n                10\n            ],\n            fc: 15\n        },\n        {\n            lngs: ['lv'],\n            nr: [\n                1,\n                2,\n                0\n            ],\n            fc: 16\n        },\n        {\n            lngs: ['mk'],\n            nr: [\n                1,\n                2\n            ],\n            fc: 17\n        },\n        {\n            lngs: ['mnk'],\n            nr: [\n                0,\n                1,\n                2\n            ],\n            fc: 18\n        },\n        {\n            lngs: ['mt'],\n            nr: [\n                1,\n                2,\n                11,\n                20\n            ],\n            fc: 19\n        },\n        {\n            lngs: ['or'],\n            nr: [\n                2,\n                1\n            ],\n            fc: 2\n        },\n        {\n            lngs: ['ro'],\n            nr: [\n                1,\n                2,\n                20\n            ],\n            fc: 20\n        },\n        {\n            lngs: ['sl'],\n            nr: [\n                5,\n                1,\n                2,\n                3\n            ],\n            fc: 21\n        },\n        {\n            lngs: [\n                'he',\n                'iw'\n            ],\n            nr: [\n                1,\n                2,\n                20,\n                21\n            ],\n            fc: 22\n        }\n    ];\n    let _rulesPluralsTypes = {\n        1: function (n) {\n            return Number(n > 1);\n        },\n        2: function (n) {\n            return Number(n != 1);\n        },\n        3: function (n) {\n            return 0;\n        },\n        4: function (n) {\n            return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n        },\n        5: function (n) {\n            return Number(n == 0 ? 0 : n == 1 ? 1 : n == 2 ? 2 : n % 100 >= 3 && n % 100 <= 10 ? 3 : n % 100 >= 11 ? 4 : 5);\n        },\n        6: function (n) {\n            return Number(n == 1 ? 0 : n >= 2 && n <= 4 ? 1 : 2);\n        },\n        7: function (n) {\n            return Number(n == 1 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n        },\n        8: function (n) {\n            return Number(n == 1 ? 0 : n == 2 ? 1 : n != 8 && n != 11 ? 2 : 3);\n        },\n        9: function (n) {\n            return Number(n >= 2);\n        },\n        10: function (n) {\n            return Number(n == 1 ? 0 : n == 2 ? 1 : n < 7 ? 2 : n < 11 ? 3 : 4);\n        },\n        11: function (n) {\n            return Number(n == 1 || n == 11 ? 0 : n == 2 || n == 12 ? 1 : n > 2 && n < 20 ? 2 : 3);\n        },\n        12: function (n) {\n            return Number(n % 10 != 1 || n % 100 == 11);\n        },\n        13: function (n) {\n            return Number(n !== 0);\n        },\n        14: function (n) {\n            return Number(n == 1 ? 0 : n == 2 ? 1 : n == 3 ? 2 : 3);\n        },\n        15: function (n) {\n            return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n        },\n        16: function (n) {\n            return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n !== 0 ? 1 : 2);\n        },\n        17: function (n) {\n            return Number(n == 1 || n % 10 == 1 && n % 100 != 11 ? 0 : 1);\n        },\n        18: function (n) {\n            return Number(n == 0 ? 0 : n == 1 ? 1 : 2);\n        },\n        19: function (n) {\n            return Number(n == 1 ? 0 : n == 0 || n % 100 > 1 && n % 100 < 11 ? 1 : n % 100 > 10 && n % 100 < 20 ? 2 : 3);\n        },\n        20: function (n) {\n            return Number(n == 1 ? 0 : n == 0 || n % 100 > 0 && n % 100 < 20 ? 1 : 2);\n        },\n        21: function (n) {\n            return Number(n % 100 == 1 ? 1 : n % 100 == 2 ? 2 : n % 100 == 3 || n % 100 == 4 ? 3 : 0);\n        },\n        22: function (n) {\n            return Number(n == 1 ? 0 : n == 2 ? 1 : (n < 0 || n > 10) && n % 10 == 0 ? 2 : 3);\n        }\n    };\n    function createRules() {\n        const rules = {};\n        sets.forEach(set => {\n            set.lngs.forEach(l => {\n                rules[l] = {\n                    numbers: set.nr,\n                    plurals: _rulesPluralsTypes[set.fc]\n                };\n            });\n        });\n        return rules;\n    }\n    class PluralResolver {\n        constructor(languageUtils, options = {}) {\n            this.languageUtils = languageUtils;\n            this.options = options;\n            this.logger = baseLogger.create('pluralResolver');\n            this.rules = createRules();\n        }\n        addRule(lng, obj) {\n            this.rules[lng] = obj;\n        }\n        getRule(code) {\n            return this.rules[code] || this.rules[this.languageUtils.getLanguagePartFromCode(code)];\n        }\n        needsPlural(code) {\n            const rule = this.getRule(code);\n            return rule && rule.numbers.length > 1;\n        }\n        getPluralFormsOfKey(code, key) {\n            const ret = [];\n            const rule = this.getRule(code);\n            if (!rule)\n                return ret;\n            rule.numbers.forEach(n => {\n                const suffix = this.getSuffix(code, n);\n                ret.push(`${ key }${ suffix }`);\n            });\n            return ret;\n        }\n        getSuffix(code, count) {\n            const rule = this.getRule(code);\n            if (rule) {\n                const idx = rule.noAbs ? rule.plurals(count) : rule.plurals(Math.abs(count));\n                let suffix = rule.numbers[idx];\n                if (this.options.simplifyPluralSuffix && rule.numbers.length === 2 && rule.numbers[0] === 1) {\n                    if (suffix === 2) {\n                        suffix = 'plural';\n                    } else if (suffix === 1) {\n                        suffix = '';\n                    }\n                }\n                const returnSuffix = () => this.options.prepend && suffix.toString() ? this.options.prepend + suffix.toString() : suffix.toString();\n                if (this.options.compatibilityJSON === 'v1') {\n                    if (suffix === 1)\n                        return '';\n                    if (typeof suffix === 'number')\n                        return `_plural_${ suffix.toString() }`;\n                    return returnSuffix();\n                } else if (this.options.compatibilityJSON === 'v2') {\n                    return returnSuffix();\n                } else if (this.options.simplifyPluralSuffix && rule.numbers.length === 2 && rule.numbers[0] === 1) {\n                    return returnSuffix();\n                }\n                return this.options.prepend && idx.toString() ? this.options.prepend + idx.toString() : idx.toString();\n            }\n            this.logger.warn(`no plural rule found for: ${ code }`);\n            return '';\n        }\n    }\n    return PluralResolver;\n});"]}